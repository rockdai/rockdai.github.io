<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="format-detection" content="telephone=no">
  <title>rockdai.com</title>
  <script src="http://libs.useso.com/js/json2/20130526/json2.min.js"></script>
  <script src="http://libs.useso.com/js/jquery/2.1.1/jquery.min.js"></script>
  <script src="./git_matrix.js"></script>
  <script src="./matrix_div.js"></script>

  <style type="text/css">
    body {
      margin: 0;
      padding: 0;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
    }
    #chart {
      position: relative;
      width: 100%;
      min-height: 400px;
      overflow-x: auto;
    }
    .rect:hover {
      border: 1px groove #000;
    }
  </style>
</head>

  <body>
    <div id="loading">
      <img src="http://rockdai.u.qiniudn.com/loading.$6839.gif" />
    </div>
    <div id="chart"></div>
    <script>
      function decodeFromBase64(input) {
        input = input.replace(/\s/g, '');
        return atob(input);
      }
      var startDate = new Date("2014-07-01");
      var endDate = new Date();
      var gridSize = 14;
      var textList = ["没能坚持！！", "控制饮食", "控制饮食+稍许运动", "控制饮食+大量运动"];
      var gitMatrix = new Chart.GitMatrix("chart", {
        "startDate": startDate,
        "endDate": endDate,
        "gridSize": gridSize,
        "textList": textList
      });

      var url = 'https://api.github.com/repos/rockdai/my_diet/contents/data.json';
      $.ajax({
        dataType: "json",
        url: url,
        headers: {
          'Accept': 'application/vnd.github.v3+json',
          'Content-Type': 'application/json;charset=UTF-8'
        },
        success: function (data) {
          $('#loading').hide();
          data = data || {};
          data = decodeFromBase64(data.content);
          data = JSON.parse(data);
          gitMatrix.loadData(data);
          gitMatrix.render();
        }
      });
    </script>
  </body>
</html>
